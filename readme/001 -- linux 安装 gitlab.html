<html>
<head>
  <title>Evernote Export</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/306729 (zh-CN, DDL); Windows/6.1.0 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="2660"/>

<div>
<span><div><span style="font-size: 14pt; font-weight: bold;">前置条件</span></div><div><font style="font-size: 10pt;"><br/></font></div><div><span style="font-size: 13.3333px;">最好在独立的环境上安装,gitlab安装包自带且依赖于 postgresql redis nginx 等中间件,如果环境本身存在该些中间件,则可能会造成无法正确连接web或者重启后无法正常访问的情况.</span></div><div><font style="font-size: 10pt;"><br/></font></div><div><span style="font-size: 14pt; font-weight: bold;">安装必要的配置和依赖</span></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">sudo yum install -y curl policycoreutils-python openssh-server</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">sudo systemctl enable sshd</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">sudo systemctl start sshd</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">sudo firewall-cmd --permanent --add-service=http</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">sudo systemctl reload firewalld</span></div></div><div><font style="font-size: 14pt;"><br/></font></div><div><span style="font-size: 14pt; font-weight: bold;">安装postfix邮件服务器</span></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">sudo yum install postfix</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">sudo systemctl enable postfix</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">sudo systemctl start postfix</span></div></div><div><br/></div><div><span style="font-size: 14pt; font-weight: bold;">添加GitLab软件包存储库并安装软件包</span></div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">#下载</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">wget --content-disposition</span> <a href="https://packages.gitlab.com/gitlab/gitlab-ce/packages/el/7/gitlab-ce-10.5.1-ce.0.el7.x86_64.rpm/download.rpm" style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">https://packages.gitlab.com/gitlab/gitlab-ce/packages/el/7/gitlab-ce-10.5.1-ce.0.el7.x86_64.rpm/download.rpm</a></div><div>#安装</div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">sudo EXTERNAL_URL=&quot;</span><a href="http://gitlab.com/" style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">http://internal.gitlab.com</a>/gitlab<span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">&quot; rpm -i gitlab-ce-10.5.1-ce.0.el7.x86_64.rpm</span></div></div><div><br/></div><div><span style="font-size: 14pt; font-weight: bold;">常用操作</span></div><div><span style="font-size: 14pt;"><br/></span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">#启动</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">sudo gitlab-ctl start</span></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">#关闭</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">sudo gitlab-ctl stop</span></div><div><br style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"/></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">#重启</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">sudo gitlab-ctl restart</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"><br/></span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">#更改配置文件后,重启服务</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">gitlab-ctl reconfigure</span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);"><br/></span></div><div><span style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">#卸载</span></div><div><a href="https://www.cnblogs.com/shansongxian/p/6678110.html" style="font-family: Monaco; font-size: 9pt; color: rgb(51, 51, 51);">https://www.cnblogs.com/shansongxian/p/6678110.html</a></div></div><div><br/></div><div><span style="font-size: 14pt; font-weight: bold;">添加账号和用户组以及设置新的项目</span></div><div><br/></div><div>默认数据存储目录:/var/opt/gitlab/git-data</div><div><br/></div><div>浏览到主机名并登录(把gitlab加入到hosts文件中)</div><div><a href="http://gitlab.com/" style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">http://internal.gitlab.com</a><span style="font-size: 9pt; color: rgb(51, 51, 51); font-family: Monaco;">/gitlab</span></div><div>第一次访问时，您将被重定向到密码重置屏幕。提供初始管理员帐户的密码，您将被重定向回登录屏幕。</div><div><br/></div><div>使用默认帐户的用户名root登录。</div><div>密码修改为:12345678</div><div><br/></div><div>1 创建用户组</div><div>2 创建用户(userName是登录用户名,name是显示的昵称)</div><div>3 进入用户组,将用户添加到组中</div><div>4 创建项目</div><div>5 进入项目为项目添加用户组</div><div>6 设置用户组权限为 开发权限或者 master权限</div><div>7 使用新建的用户登录,拉取项目.</div><div><br/></div><div><br/></div><div><span style="font-size: 14pt; font-weight: bold;">安装客户端 Treesource</span></div><div><br/></div><div>1 下载安装treesurce</div><div>    <a href="https://www.sourcetreeapp.com/">https://www.sourcetreeapp.com/</a></div><div>    <br/></div><div>    <img src="001 -- linux 安装 gitlab_files/Image.png" type="image/png" data-filename="Image.png"/><br/></div><div><br/></div><div>2 下载安装git for widdows</div><div>    <a href="https://gitforwindows.org/">https://gitforwindows.org/</a></div><div><br/></div><div>    <img src="001 -- linux 安装 gitlab_files/Image [1].png" type="image/png" data-filename="Image.png"/><br/></div><div><br/></div><div>3 在windows本地生产ssh可以,并且上传到自己的gitlab中</div><div>    鼠标在桌面右键--&gt; Git Bash Here</div><div>    输入:<br/></div><div>    ssh-keygen -t rsa -C &quot;<a href="mailto:zrkjava@163.com">zrkjava@163.com</a>&quot;<br/></div><div><br/></div><div>4 在 C:\Users\DELL\.ssh 中用记事本打开 id_rsa.pub ,并且复制内容到gitlab</div><div><br/></div><div>    <img src="001 -- linux 安装 gitlab_files/Image [2].png" type="image/png" data-filename="Image.png"/><br/></div><div>    <br/></div><div>    右上角选择 settings--&gt;左侧选择SSH Keys<br/></div><div><br/></div><div><br/></div><div>    <img src="001 -- linux 安装 gitlab_files/Image [3].png" type="image/png" data-filename="Image.png" width="1027"/><br/></div><div><br/></div><div>    将key内如赋值到其中,titile可以输入为该账号的Name<br/></div><div><br/></div><div><br/></div><div>    <img src="001 -- linux 安装 gitlab_files/Image [4].png" type="image/png" data-filename="Image.png" width="1033"/><br/></div><div><br/></div><div>    添加成功<br/></div><div><br/></div><div>    <img src="001 -- linux 安装 gitlab_files/Image [5].png" type="image/png" data-filename="Image.png"/><br/></div><div><br/></div><div><br/></div><div>    5 在Treesource中设置为使用ssh连接<br/></div><div><br/></div><div>            <img src="001 -- linux 安装 gitlab_files/Image [6].png" type="image/png" data-filename="Image.png"/>  </div><div><br/></div><div><br/></div><div>点击工具--&gt;添加ssh密钥,将ssh私钥添加</div><div><img src="001 -- linux 安装 gitlab_files/Image [7].png" type="image/png" data-filename="Image.png" width="1187"/></div><div><br/></div><div>      <br/></div><div><br/></div><div>   6 复制项目地址,在treesource中拉取<br/></div><div>      注意在hosts文件中进行内网域名转换,如:</div><div>      192.168.188.81 <a href="http://internal.gitlab.com/">internal.gitlab.com</a></div><div><br/></div><div>    <img src="001 -- linux 安装 gitlab_files/Image [8].png" type="image/png" data-filename="Image.png"/><br/></div><div><br/></div><div><br/></div><div>    <br/></div><div> 7 在treesource中<span style="font-weight: bold;">克隆</span>这个地址,然后<span style="font-weight: bold;">提交和推送</span> 一个测试文件</div><div><br/></div><div> 8 项目中至少有了一个文件之后,可以创建分支,合并分支.</div><div>    <br/></div><div>    分支:  选择master,然后选择分支,创建新的的分支<br/></div><div><br/></div><div>    合并分支:<span style="font-weight: bold;">双击</span>左侧master,在右边选择有合并的分支<span style="font-weight: bold;">,右键合并</span>,<span style="font-weight: bold;">确认</span>后点击<span style="font-weight: bold;">推送.</span><br/></div><div>                    <img src="001 -- linux 安装 gitlab_files/Image [9].png" type="image/png" data-filename="Image.png"/><br/></div><div><br/></div><div><br/></div><div>9 删除分支</div><div>   将分支合并到master之后,则可以删除分支.<br/></div><div><br/></div><div>10 建议了解一下 git flow以及 在tree source中如何使用git flow</div><div><br/></div></span>
</div></body></html> 